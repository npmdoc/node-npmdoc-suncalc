<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/mourner/suncalc">suncalc (v1.8.0)</a>
</h1>
<h4>A tiny JavaScript library for calculating sun/moon positions and phases.</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.suncalc">module suncalc</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.suncalc.addTime">
            function <span class="apidocSignatureSpan">suncalc.</span>addTime
            <span class="apidocSignatureSpan">(angle, riseName, setName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.suncalc.getMoonIllumination">
            function <span class="apidocSignatureSpan">suncalc.</span>getMoonIllumination
            <span class="apidocSignatureSpan">(date)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.suncalc.getMoonPosition">
            function <span class="apidocSignatureSpan">suncalc.</span>getMoonPosition
            <span class="apidocSignatureSpan">(date, lat, lng)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.suncalc.getMoonTimes">
            function <span class="apidocSignatureSpan">suncalc.</span>getMoonTimes
            <span class="apidocSignatureSpan">(date, lat, lng, inUTC)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.suncalc.getPosition">
            function <span class="apidocSignatureSpan">suncalc.</span>getPosition
            <span class="apidocSignatureSpan">(date, lat, lng)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.suncalc.getTimes">
            function <span class="apidocSignatureSpan">suncalc.</span>getTimes
            <span class="apidocSignatureSpan">(date, lat, lng)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">suncalc.</span>times</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.suncalc" id="apidoc.module.suncalc">module suncalc</a></h1>


    <h2>
        <a href="#apidoc.element.suncalc.addTime" id="apidoc.element.suncalc.addTime">
        function <span class="apidocSignatureSpan">suncalc.</span>addTime
        <span class="apidocSignatureSpan">(angle, riseName, setName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addTime = function (angle, riseName, setName) {
    times.push([angle, riseName, setName]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
| `night`         | night starts (dark enough for astronomical observations)                 |
| `nadir`         | nadir (darkest moment of the night, sun is in the lowest position)       |
| `nightEnd`      | night ends (morning astronomical twilight starts)                        |
| `nauticalDawn`  | nautical dawn (morning nautical twilight starts)                         |
| `dawn`          | dawn (morning nautical twilight ends, morning civil twilight starts)     |

```javascript
SunCalc.<span class="apidocCodeKeywordSpan">addTime</span>(/*Number*/ angleInDegrees, /*String*/ morningName, /*String*/ eveningName
)
```

Adds a custom time when the sun reaches the given angle to results returned by `SunCalc.getTimes`.

`SunCalc.times` property contains all currently defined times.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.suncalc.getMoonIllumination" id="apidoc.element.suncalc.getMoonIllumination">
        function <span class="apidocSignatureSpan">suncalc.</span>getMoonIllumination
        <span class="apidocSignatureSpan">(date)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMoonIllumination = function (date) {

    var d = toDays(date || new Date()),
        s = sunCoords(d),
        m = moonCoords(d),

        sdist = 149598000, // distance from Earth to Sun in km

        phi = acos(sin(s.dec) * sin(m.dec) + cos(s.dec) * cos(m.dec) * cos(s.ra - m.ra)),
        inc = atan(sdist * sin(phi), m.dist - sdist * cos(phi)),
        angle = atan(cos(s.dec) * sin(s.ra - m.ra), sin(s.dec) * cos(m.dec) -
                cos(s.dec) * sin(m.dec) * cos(s.ra - m.ra));

    return {
        fraction: (1 + cos(inc)) / 2,
        phase: 0.5 + 0.5 * inc * (angle &lt; 0 ? -1 : 1) / Math.PI,
        angle: angle
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* `distance`: distance to moon in kilometers
* `parallacticAngle`: parallactic angle of the moon in radians


### Moon illumination

```javascript
SunCalc.<span class="apidocCodeKeywordSpan">getMoonIllumination</span>(/*Date*/ timeAndDate)
```

Returns an object with the following properties:

* `fraction`: illuminated fraction of the moon; varies from `0.0` (new moon) to `1.0` (full moon)
* `phase`: moon phase; varies from `0.0` to `1.0`, described below
* `angle`: midpoint angle in radians of the illuminated limb of the moon reckoned eastward from the north point of the disk;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.suncalc.getMoonPosition" id="apidoc.element.suncalc.getMoonPosition">
        function <span class="apidocSignatureSpan">suncalc.</span>getMoonPosition
        <span class="apidocSignatureSpan">(date, lat, lng)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMoonPosition = function (date, lat, lng) {

    var lw  = rad * -lng,
        phi = rad * lat,
        d   = toDays(date),

        c = moonCoords(d),
        H = siderealTime(d, lw) - c.ra,
        h = altitude(H, phi, c.dec),
        // formula 14.1 of "Astronomical Algorithms" 2nd edition by Jean Meeus (Willmann-Bell, Richmond) 1998.
        pa = atan(sin(H), tan(phi) * cos(c.dec) - sin(c.dec) * cos(H));

    h = h + astroRefraction(h); // altitude correction for refraction

    return {
        azimuth: azimuth(H, phi, c.dec),
        altitude: h,
        distance: c.dist,
        parallacticAngle: pa
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* `azimuth`: sun azimuth in radians (direction along the horizon, measured from south to west),
e.g. `0` is south and `Math.PI * 3/4` is northwest


### Moon position

```javascript
SunCalc.<span class="apidocCodeKeywordSpan">getMoonPosition</span>(/*Date*/ timeAndDate, /*Number*/ latitude, /*Number*/ longitude
)
```

Returns an object with the following properties:

* `altitude`: moon altitude above the horizon in radians
* `azimuth`: moon azimuth in radians
* `distance`: distance to moon in kilometers
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.suncalc.getMoonTimes" id="apidoc.element.suncalc.getMoonTimes">
        function <span class="apidocSignatureSpan">suncalc.</span>getMoonTimes
        <span class="apidocSignatureSpan">(date, lat, lng, inUTC)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMoonTimes = function (date, lat, lng, inUTC) {
    var t = new Date(date);
    if (inUTC) t.setUTCHours(0, 0, 0, 0);
    else t.setHours(0, 0, 0, 0);

    var hc = 0.133 * rad,
        h0 = SunCalc.getMoonPosition(t, lat, lng).altitude - hc,
        h1, h2, rise, set, a, b, xe, ye, d, roots, x1, x2, dx;

    // go in 2-hour chunks, each time seeing if a 3-point quadratic curve crosses zero (which means rise or set)
    for (var i = 1; i &lt;= 24; i += 2) {
        h1 = SunCalc.getMoonPosition(hoursLater(t, i), lat, lng).altitude - hc;
        h2 = SunCalc.getMoonPosition(hoursLater(t, i + 1), lat, lng).altitude - hc;

        a = (h0 + h2) / 2 - h1;
        b = (h2 - h0) / 2;
        xe = -b / (2 * a);
        ye = (a * xe + b) * xe + h1;
        d = b * b - 4 * a * h1;
        roots = 0;

        if (d &gt;= 0) {
            dx = Math.sqrt(d) / (Math.abs(a) * 2);
            x1 = xe - dx;
            x2 = xe + dx;
            if (Math.abs(x1) &lt;= 1) roots++;
            if (Math.abs(x2) &lt;= 1) roots++;
            if (x1 &lt; -1) x1 = x2;
        }

        if (roots === 1) {
            if (h0 &lt; 0) rise = i + x1;
            else set = i + x1;

        } else if (roots === 2) {
            rise = i + (ye &lt; 0 ? x2 : x1);
            set = i + (ye &lt; 0 ? x1 : x2);
        }

        if (rise &amp;&amp; set) break;

        h0 = h2;
    }

    var result = {};

    if (rise) result.rise = hoursLater(t, rise);
    if (set) result.set = hoursLater(t, set);

    if (!rise &amp;&amp; !set) result[ye &gt; 0 ? 'alwaysUp' : 'alwaysDown'] = true;

    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

By subtracting the `parallacticAngle` from the `angle` one can get the zenith angle of the moons bright limb (anticlockwise).
The zenith angle can be used do draw the moon shape from the observers perspective (e.g. moon lying on its back).

### Moon rise and set times

```js
SunCalc.<span class="apidocCodeKeywordSpan">getMoonTimes</span>(/*Date*/ date, /*Number*/ latitude, /*Number*/ longitude[, inUTC
])
```

Returns an object with the following properties:

* `rise`: moonrise time as `Date`
* `set`: moonset time as `Date`
* `alwaysUp`: `true` if the moon never rises/sets and is always _above_ the horizon during the day
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.suncalc.getPosition" id="apidoc.element.suncalc.getPosition">
        function <span class="apidocSignatureSpan">suncalc.</span>getPosition
        <span class="apidocSignatureSpan">(date, lat, lng)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPosition = function (date, lat, lng) {

    var lw  = rad * -lng,
        phi = rad * lat,
        d   = toDays(date),

        c  = sunCoords(d),
        H  = siderealTime(d, lw) - c.ra;

    return {
        azimuth: azimuth(H, phi, c.dec),
        altitude: altitude(H, phi, c.dec)
    };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// get today's sunlight times for London
var times = SunCalc.getTimes(new Date(), 51.5, -0.1);

// format sunrise time from the Date object
var sunriseStr = times.sunrise.getHours() + ':' + times.sunrise.getMinutes();

// get position of the sun (azimuth and altitude) at today's sunrise
var sunrisePos = SunCalc.<span class="apidocCodeKeywordSpan">getPosition</span>(times.sunrise, 51.5, -0.1);

// get sunrise azimuth in degrees
var sunriseAzimuth = sunrisePos.azimuth * 180 / Math.PI;
```

SunCalc is also available as an NPM package:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.suncalc.getTimes" id="apidoc.element.suncalc.getTimes">
        function <span class="apidocSignatureSpan">suncalc.</span>getTimes
        <span class="apidocSignatureSpan">(date, lat, lng)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getTimes = function (date, lat, lng) {

    var lw = rad * -lng,
        phi = rad * lat,

        d = toDays(date),
        n = julianCycle(d, lw),
        ds = approxTransit(0, lw, n),

        M = solarMeanAnomaly(ds),
        L = eclipticLongitude(M),
        dec = declination(L, 0),

        Jnoon = solarTransitJ(ds, M, L),

        i, len, time, Jset, Jrise;


    var result = {
        solarNoon: fromJulian(Jnoon),
        nadir: fromJulian(Jnoon - 0.5)
    };

    for (i = 0, len = times.length; i &lt; len; i += 1) {
        time = times[i];

        Jset = getSetJ(time[0] * rad, lw, phi, dec, n, M, L);
        Jrise = Jnoon - (Jset - Jnoon);

        result[time[1]] = fromJulian(Jrise);
        result[time[2]] = fromJulian(Jset);
    }

    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
in the [Twilight article on Wikipedia](http://en.wikipedia.org/wiki/Twilight).


## Usage example

```javascript
// get today's sunlight times for London
var times = SunCalc.<span class="apidocCodeKeywordSpan">getTimes</span>(new Date(), 51.5, -0.1);

// format sunrise time from the Date object
var sunriseStr = times.sunrise.getHours() + ':' + times.sunrise.getMinutes();

// get position of the sun (azimuth and altitude) at today's sunrise
var sunrisePos = SunCalc.getPosition(times.sunrise, 51.5, -0.1);
...</pre></li>
    </ul>




</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>